---
lab:
  az204Title: 'Lab 12: Enhance a web application by using the Azure Content Delivery Network'
  az204Module: 'Module 12: Integrate caching and content delivery within solutions'
---

# <a name="lab-12-enhance-a-web-application-by-using-the-azure-content-delivery-network"></a>ラボ 12: Azure Content Delivery Network を使用した Web アプリケーションの強化

## <a name="microsoft-azure-user-interface"></a>Microsoft Azure ユーザー インターフェイス

Given the dynamic nature of Microsoft cloud tools, you might experience Azure UI changes that occur after the development of this training content. As a result, the lab instructions and lab steps might not align correctly.

Microsoft updates this training course when the community alerts us to needed changes. However, cloud updates occur frequently, so you might encounter UI changes before this training content updates. <bpt id="p1">**</bpt>If this occurs, adapt to the changes, and then work through them in the labs as needed.<ept id="p1">**</ept>

## <a name="instructions"></a>Instructions

### <a name="before-you-start"></a>開始する前に

#### <a name="sign-in-to-the-lab-environment"></a>ラボ環境にサインインする

次の資格情報を使用して Windows 10 仮想マシン (VM) にサインインします。

- ユーザー名: **Admin**

- パスワード: **Pa55w.rd**

> **注**: 仮想ラボ環境に接続するための手順は、インストラクターから提供されます。

#### <a name="review-the-installed-applications"></a>インストールされているアプリケーションを確認する

Find the taskbar on your Windows 10 desktop. The taskbar contains the icon for the application that you'll use in this lab:

- Microsoft Edge

## <a name="architecture-diagram"></a>アーキテクチャの図

![Azure Content Delivery Network を使用して web アプリケーションを強化するユーザーを表すアーキテクチャの図](./media/Lab12-Diagram.png)

### <a name="exercise-1-create-azure-resources"></a>演習 1: Azure リソースを作成する

#### <a name="task-1-open-the-azure-portal"></a>タスク 1: Azure portal を開く

1. タスク バーで、**Microsoft Edge** アイコンを選択します。

1. 開いたブラウザー ウィンドウで、Azure portal (<https://portal.azure.com>) にアクセスしてから、このラボで使用するアカウントでサインインします。

   > Microsoft クラウド ツールの動的な性質を考慮すると、このトレーニング コンテンツの開発の後に発生する Azure UI の変更に気付くかもしれません。

#### <a name="task-2-create-a-storage-account"></a>タスク 2: ストレージ アカウントを作成する

1. Azure portal で、 **[リソース、サービス、ドキュメントの検索]** テキスト ボックスを使用して「**ストレージ アカウント**」を検索し、結果のリストで **[ストレージ アカウント]** を選択します。

1.  **[ストレージ アカウント]**  ブレードで **[+ 作成]** を選択します。

1. **[ストレージ アカウントを作成する]** ブレードの **[基本]** タブで、次のアクションを実行し、 **[確認と作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[サブスクリプション]** ドロップダウン リスト | 既定値のままにします |
   | **[リソース グループ]** セクション | **[新規作成]** を選択し、「**MarketingContent**」と入力し、 **[OK]** を選択します。 |
   | **[ストレージ アカウント名]**  テキスト ボックス | 「**contenthost** _[ご自分の名前]_ 」と入力します |
   | **[リージョン]** ドロップダウン リスト | **[(米国) 米国東部]** を選択します |
   | **[パフォーマンス]** セクション | **[Standard]** オプションを選択します |
   | **[冗長性]** ドロップダウン リスト | **[ローカル冗長ストレージ (LRS)]** を選択します |

    次のスクリーンショットには、 **[ストレージ アカウントを作成する]** ブレードで構成された設定が表示されています。

    ![[ストレージ アカウントを作成する] ブレードで構成された設定を表示したスクリーンショット](./media/l12_create_a_storage_account.png)

1. **[確認および作成]** タブで、前の手順で選択したオプションを確認します。

1. **[作成]** を選択して、指定した構成を使用してストレージ アカウントを作成します。

    > **注**: 作成タスクが完了するまで待ってから、このラボを続行してください。

#### <a name="task-3-create-a-web-app-by-using-azure-app-service"></a>タスク 3: Azure App Service を使用して Web アプリを作成する

1. Azure portal のナビゲーション ウィンドウで **[リソースの作成]** を選択します。

1. **[リソースの作成]** ブレードで、**[サービスとマーケットプレースの検索]** テキスト ボックスに「**Web アプリ**」と入力し、Enter キーを押します。

1. 検索結果ブレードで、"**Web アプリ**" という結果を選択し、 **[作成]** を選択します。

1. **[Web アプリの作成]** ブレードの **[基本]** タブで、次のアクションを実行してから、 **[次へ: Docker]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[サブスクリプション]** ドロップダウン リスト | 既定値のままにします |
   | **[リソース グループ]** ドロップダウン リスト | リストで **[MarketingContent]** を選択します。 |
   | **[名前]**  テキスト ボックス | 「**landingpage** _[ご自分の名前]_ 」と入力します。 |
   | **[公開]** セクション | **[Docker コンテナー]** を選択します |
   | **[オペレーティング システム]** セクション | **[Linux]** を選択します |
   | **[リージョン]** ドロップダウン リスト | **[米国東部]** を選択します。 |
   | **[Linux プラン (米国東部)]** セクション | その結果、ラボの指示とラボの手順が正しく整合しなくなる可能性があります。 |
   | **[SKU とサイズ]** セクション | 既定値のままにします |

   次のスクリーンショットは、 **[Web アプリの作成]** ブレードで構成されている設定を示しています。

   ![[Web アプリの作成] ブレードで構成された設定を表示したスクリーンショット](./media/l12_create_web_app.png)

1. **[Docker]** タブで、次のアクションを実行し、 **[確認と作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[オプション]** ドロップダウン リスト | **[単一コンテナー]** を選択します |
   | **[イメージのソース]** ドロップダウン リスト | **[Docker Hub]** を選択します |
   | **[アクセスの種類]** ドロップダウン リスト | **[Public]** を選択します |
   | **[イメージとタグ]** テキスト ボックス | 「**microsoftlearning/edx-html-landing-page:latest**」と入力します。 |

   次のスクリーンショットは、 **[Docker]** タブで構成されている設定を示しています。

   ![[Web アプリの作成] の [Docker] タブで構成されている設定を表示したスクリーンショット](./media/l12_create_web_app_docker.png)

1. **[確認と作成]** タブで、前の手順で選択したオプションを確認します。

1. **[作成]** を選択して、指定した構成を使用して Web アプリを作成します。

    > **注**: 作成タスクが完了するまで待ってから、このラボを続行してください。

1. **[デプロイ]** ブレードで、**[リソースに移動]** を選択します。

1. On the <bpt id="p1">**</bpt>App Service Overview<ept id="p1">**</ept> blade, in the <bpt id="p2">**</bpt>Essentials<ept id="p2">**</ept>, record the value of the <bpt id="p3">**</bpt>URL<ept id="p3">**</ept> link. You'll use this value later in the lab.

#### <a name="review"></a>確認

この演習では、このラボで後ほど使用する Azure Storage アカウントと Azure Web アプリを作成しました。

### <a name="exercise-2-configure-content-delivery-network-and-endpoints"></a>演習 2: Content Delivery Network とエンドポイントを構成する

#### <a name="task-1-open-azure-cloud-shell"></a>タスク 1: Azure Cloud Shell を開く

1. Microsoft は、コミュニティから必要な変更の通知があったときに、このトレーニング コースを更新します。

    > ただし、クラウドの更新は頻繁に発生するため、このトレーニング コンテンツの更新の前に UI の変更に気付く可能性があります。

1. Azure portal の **Cloud Shell** コマンド プロンプトで、次のコマンドを実行して、Azure コマンド ライン インターフェイス (Azure CLI) ツールのバージョンを取得します。

    ```bash
    az --version
    ```

#### <a name="task-2-register-the-microsoftcdn-provider"></a>タスク 2: Microsoft.CDN プロバイダーを登録する

1. Azure portal の **Cloud Shell** コマンド プロンプトで、次の操作を実行します。

    **これが発生した場合は、その変更に適応し、ラボでは必要に応じてそれらに対応してください。**

    ```bash
    az --help
    ```

    b.  Enter the following command, and then select Enter to get a list of the commands that are available for resource providers:

    ```bash
    az provider --help
    ```

    c.  Enter the following command, and then select Enter to list all currently registered providers:

     ```bash
     az provider list
     ```

    d.  Enter the following command, and then select Enter to list only the namespaces of the currently registered providers:

     ```bash
     az provider list --query "[?registrationState=='Registered'].namespace"
     ```

    e.  Observe the list of currently registered providers. The <bpt id="p1">**</bpt>Microsoft.CDN<ept id="p1">**</ept> provider isn't currently in the list of providers.

    f.  Enter the following command, and then select Enter to get the required flags to register a new provider:

     ```bash
     az provider register --help
     ```

    g.  Enter the following command, and then select Enter to register the <bpt id="p1">**</bpt>Microsoft.CDN<ept id="p1">**</ept> namespace with your current subscription:

     ```bash
     az provider register --namespace Microsoft.CDN
     ```

1. Azure portal の **[Cloud Shell]** ウィンドウを閉じます。

#### <a name="task-3-create-a-content-delivery-network-profile"></a>タスク 3: Content Delivery Network プロファイルを作成する

1. Azure portal のナビゲーション ウィンドウで **[リソースの作成]** を選択します。

1. **[リソースの作成]** ブレードの **[サービスとマーケットプレースの検索]** テキスト ボックスに「**CDN**」と入力し、Enter キーを押します。

1. **[マーケットプレース]** 検索結果ブレードで、 **[Front Door と CDN プロファイル]** という結果を選択し、 **[作成]** を選択します。

1. **[Compare offerings](オファリングの比較)** ページで、 **[その他のオファリングの探索]** を選択し、 **[Azure CDN Standard from Akamai]** を選択した後、 **[続行]** を選択します。

1. **[CDN プロファイル]** ブレードの **[基本]** タブで、次のアクションを実行してから、 **[確認と作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[サブスクリプション]** ドロップダウン リスト | 既定値のままにします |
   | **[リソース グループ]** ドロップダウン リスト | リストで **[MarketingContent]** を選択します。 |
   | **[名前]**  テキスト ボックス | 「**contentdeliverynetwork**」と入力します |
   | **[領域]** テキスト ボックス | 既定値のままにします (グローバル) |
   | **[価格レベル]** ドロップダウン リスト | **[Standard Akamai]** を選択します |
   | **[今すぐ新しい CDN エンドポイントを作成する]** チェック ボックス | オフ |

   次のスクリーンショットは、 **[CDN プロファイル]** ブレードで構成されている設定を示しています。

   ![[CDN プロファイルの作成] ブレードで構成された設定を表示したスクリーンショット。](./media/l12_create_CDN_profile.png)

1. **[確認と作成]** タブで、前の手順で選択したオプションを確認します。

1. **[作成]** を選択して、指定した構成を使用して CDN プロファイルを作成します。
  
    > <bpt id="p1">**</bpt>Note<ept id="p1">**</ept>: Wait for Azure to finish creating the CDN profile before you move forward with the lab. You'll receive a notification when the app is created.

#### <a name="task-4-configure-storage-containers"></a>タスク 4: ストレージ コンテナーを構成する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contenthost** _[yourname]_ ストレージ アカウントを選択します。

1. **[ストレージ アカウント]** ブレードで、 **[データ ストレージ]** セクションの **[コンテナー]** リンクを選択します。

1. **[コンテナー]** セクションで、 **[+ コンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップ ウィンドウで、次のアクションを実行し、 **[作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**media**」と入力します |
   | **[パブリック アクセス レベル]** ドロップダウン リスト | **[BLOB (BLOB 専用の匿名読み取りアクセス)]** を選択します。 |

1. **[コンテナー]** セクションで、もう一度、 **[+ コンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップ ウィンドウで、次のアクションを実行し、 **[作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**video**」と入力します |
   | **[パブリック アクセス レベル]** ドロップダウン リスト | **[BLOB (BLOB 専用の匿名読み取りアクセス)]** を選択します。 |

1. 更新されたコンテナーの一覧で、**media** コンテナーと **video** コンテナーが両方とも表示されていることを確認します。

#### <a name="task-5-create-content-delivery-network-endpoints"></a>タスク 5: Content Delivery Network エンドポイントを作成する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** リンクを選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contentdeliverynetwork** CDN プロファイルを選択します。

1. **[CDN プロファイル]** ブレードで **[+ エンドポイント]** を選択します。

1. **[エンドポイントの追加]** ポップアップ ダイアログ ボックスで、次の操作を実行し、 **[追加]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**cdnmedia**_<ご自分の名前>_」と入力します |
   | **[配信元の種類]** ドロップダウン リスト | **[ストレージ]** を選びます |
   | **[配信元のホスト名]** ドロップダウン リスト | このラボで前に作成したストレージ アカウントの **[contenthost *[ご自分の名前]* .blob.core.windows.net]** オプションを選択します |
   | **[配信元のパス]** テキスト ボックス | 「**/media**」と入力します |
   | **[配信元のホスト ヘッダー]** テキスト ボックス | 既定値のままにします |
   | **[プロトコル]** セクションと **[配信元のポート]** セクション | 既定値のままにします |
   | **[最適化の対象]** ドロップダウン リスト | **[一般的な Web 配信]** を選択します |

   次のスクリーンショットには、 **[エンドポイントの追加]** ダイアログ ボックスで構成された設定が表示されています。

   ![次のスクリーンショットには、[エンドポイントの追加] ダイアログ ボックスで構成された設定が表示されています。](./media/l12_add_an_endpoint.png)

1. **[CDN プロファイル]** ブレードで、もう一度、 **[+ エンドポイント]** を選択します。

1. **[エンドポイントの追加]** ポップアップ ダイアログ ボックスで、次の操作を実行し、 **[追加]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**cdnvideo**_<ご自分の名前>_」と入力します |
   | **[配信元の種類]** ドロップダウン リスト | **[ストレージ]** を選びます |
   | **[配信元のホスト名]** ドロップダウン リスト | このラボで前に作成したストレージ アカウントの **[contenthost *[ご自分の名前]* .blob.core.windows.net]** オプションを選択します |
   | **[配信元のパス]** テキスト ボックス | 「**/video**」と入力します |
   | **[配信元のホスト ヘッダー]** テキスト ボックス | 既定値のままにします |
   | **[プロトコル]** セクションと **[配信元のポート]** セクション | 既定値のままにします |
   | **[最適化の対象]** ドロップダウン リスト | **[ビデオ オン デマンドのメディア ストリーミング]** を選択します |

   次のスクリーンショットには、 **[エンドポイントの追加]** ダイアログ ボックスで構成された設定が表示されています。

   ![次のスクリーンショットには、[エンドポイントの追加] ダイアログ ボックスで構成された設定が表示されています。](./media/l12_add_an_endpoint2.png)

1. **[CDN プロファイル]** ブレードで、もう一度、 **[+ エンドポイント]** を選択します。

1. **[エンドポイントの追加]** ポップアップ ダイアログ ボックスで、次の操作を実行し、 **[追加]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**cdnweb**_<ご自分の名前>_」と入力します |
   | **[配信元の種類]** ドロップダウン リスト | **[Web アプリ]** を選択します |
   | **[配信元のホスト名]** ドロップダウン リスト | このラボで前に作成した、Web アプリの **[landingpage *[ご自分の名前]* .azurewebsites.net]** オプションを選択します。 |
   | **[配信元のパス]** テキスト ボックス | 既定値のままにします |
   | **[配信元のホスト ヘッダー]** テキスト ボックス | 既定値のままにします |
   | **[プロトコル]** セクションと **[配信元のポート]** セクション | 既定値のままにします |
   | **[最適化の対象]** ドロップダウン リスト | **[一般的な Web 配信]** を選択します |

   次のスクリーンショットには、 **[エンドポイントの追加]** ダイアログ ボックスで構成された設定が表示されています。

   ![次のスクリーンショットには、[エンドポイントの追加] ダイアログ ボックスで構成された設定が表示されています。](./media/l12_add_an_endpoint3.png)

#### <a name="review"></a>確認

この演習では、Content Delivery Network (CDN) のリソース プロバイダーを登録し、次に、プロバイダーを使用して CDN プロファイルとエンドポイント リソースの両方を作成しました。

### <a name="exercise-3-upload-and-configure-static-web-content"></a>演習 3: 静的 Web コンテンツをアップロードし、構成する

#### <a name="task-1-observe-the-landing-page"></a>タスク 1: ランディング ページを確認する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. On the <bpt id="p1">**</bpt>App Service<ept id="p1">**</ept> blade, select <bpt id="p2">**</bpt>Browse<ept id="p2">**</ept>. A new browser tab opens and returns the current website. Observe the error message displayed on the screen. The website won't work until you configure the specified settings to reference multimedia content.

1. 現在、開いているブラウザー ウィンドウに戻ります。ここには、Azure portal が表示されています。

#### <a name="task-2-upload-storage-blobs"></a>タスク 2: Storage BLOB をアップロードする

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contenthost** _[yourname]_ ストレージ アカウントを選択します。

1. **[ストレージ アカウント]** ブレードで、 **[データ ストレージ]** セクションの **[コンテナー]** リンクを選択します。

1. **[コンテナー]** セクションで **media** コンテナーを選択し、 **[アップロード]** を選択します。

1. **[BLOB のアップロード]** ポップアップ ウィンドウで、次のアクションを実行します。

    a.  In the <bpt id="p1">**</bpt>Files<ept id="p1">**</ept> section, select the <bpt id="p2">**</bpt>Folder<ept id="p2">**</ept> icon.

    Windows 10 デスクトップでタスク バーを見つけます。

    - **campus.jpg**

    - **conference.jpg**

    - **poster.jpg**

    タスク バーには、このラボで使用するアプリケーションのアイコンが含まれています。  

    > **注**: BLOB がアップロードされるまで待ってから、このラボを続行してください。

1. **[コンテナー]** ブレードで、 **[設定]** セクションの **[プロパティ]** を選択します。

1. Record the value in the <bpt id="p1">**</bpt>URL<ept id="p1">**</ept> text box. You'll use this value later in the lab.

1. **[コンテナー]** ブレードを閉じます。

1. **[コンテナー]** ブレードで **video** コンテナーを選択し、 **[アップロード]** を選択します。

1. **[BLOB のアップロード]** ポップアップ ウィンドウで、次のアクションを実行します。

    a.  In the <bpt id="p1">**</bpt>Files<ept id="p1">**</ept> section, select the <bpt id="p2">**</bpt>Folder<ept id="p2">**</ept> icon.

    b.  In the <bpt id="p1">**</bpt>File Explorer<ept id="p1">**</ept> window, browse to <bpt id="p2">**</bpt>Allfiles (F):<ph id="ph1">\\</ph>Allfiles<ph id="ph2">\\</ph>Labs<ph id="ph3">\\</ph>12<ph id="ph4">\\</ph>Starter<ept id="p2">**</ept>, select the <bpt id="p3">**</bpt>welcome.mp4<ept id="p3">**</ept> file, and then select <bpt id="p4">**</bpt>Open<ept id="p4">**</ept>.

    c.  Ensure that <bpt id="p1">**</bpt>Overwrite if files already exist<ept id="p1">**</ept> is selected, and then select <bpt id="p2">**</bpt>Upload<ept id="p2">**</ept>.  

    > **注**: BLOB がアップロードされるまで待ってから、このラボを続行してください。

1. **[コンテナー]** ブレードで、 **[設定]** セクションの **[プロパティ]** を選択します。

1. Record the value in the <bpt id="p1">**</bpt>URL<ept id="p1">**</ept> text box. You'll use this value later in the lab.

#### <a name="task-3-configure-web-app-settings"></a>タスク 3: Web アプリの設定を構成する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードの **[設定]** カテゴリで **[構成]** リンクを選択します。

1. **[構成]** セクションで **[アプリケーション設定]** タブを選択してから、 **[新しいアプリケーション設定]** を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ウィンドウで、以下の設定を構成し、 **[OK]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**CDNMediaEndpoint**」と入力します |
   | **[値]** テキスト ボックス | このラボで前に記録した、**contenthost** _[ご自分の名前]_ ストレージ アカウントの **media** コンテナーの **URI** 値を入力します。 |
   | **[デプロイ スロットの設定]** チェック ボックス | 選択しません |

1. **[構成]** セクション に戻り、 **[新しいアプリケーション設定]** を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ウィンドウで、以下の設定を構成し、 **[OK]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]**  テキスト ボックス | 「**CDNVideoEndpoint**」と入力します。 |
   | **[値]** テキスト ボックス | このラボで前に記録した、**contenthost** _[ご自分の名前]_ ストレージ アカウントの **video** コンテナーの **URI** 値を入力します |
   | **[デプロイ スロットの設定]** チェック ボックス | 選択しません |

1. Return to the <bpt id="p1">**</bpt>Configuration<ept id="p1">**</ept> section, and then select <bpt id="p2">**</bpt>Save<ept id="p2">**</ept>. Select <bpt id="p1">**</bpt>Continue<ept id="p1">**</ept> to confirm your changes.

   > **注**: アプリケーション設定が保持されるまで待ってから、このラボを続行してください。

#### <a name="task-4-validate-the-corrected-landing-page"></a>タスク 4: 修正されたランディング ページを検証する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードで **[再起動]** を選択し、 **[はい]** を選択して、アプリの再起動プロセスを確定します。

   > <bpt id="p1">**</bpt>Note<ept id="p1">**</ept>: Wait for the restart operation to complete before you move forward with the lab. You'll receive a notification when the operation is done.

1. On the <bpt id="p1">**</bpt>App Service<ept id="p1">**</ept> blade, select <bpt id="p2">**</bpt>Browse<ept id="p2">**</ept>. A new browser window or tab will open and return to the current website. Observe the updated website rendering multimedia content of various types.

1. 現在、開いているブラウザー ウィンドウに戻ります。ここには、Azure portal が表示されています。

#### <a name="review"></a>確認

この演習では、マルチメディア コンテンツを BLOB としてストレージ コンテナーにアップロードした後、Web アプリを更新してストレージ BLOB を直接指すようにしました。

### <a name="exercise-4-use-content-delivery-network-endpoints"></a>演習 4: Content Delivery Network エンドポイントを使用する

#### <a name="task-1-retrieve-endpoint-uniform-resource-identifiers-uris"></a>タスク 1: エンドポイントの Uniform Resource Identifier (URI) を取得する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** リンクを選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contentdeliverynetwork** CDN プロファイルを選択します。

1. **[CDN プロファイル]** ブレードで **cdnmedia** _[yourname]_ エンドポイントを選択します。

1. **注**:初めて Azure portal にサインインする場合は、このポータルのツアーが表示されます。

1. **[エンドポイント]** ブレードを閉じます。

1. **[CDN プロファイル]** ブレードで **cdnvideo** _[yourname]_ エンドポイントを選択します。

1. **[はじめに]** を選択してツアーをスキップし、ポータルの使用を開始します。

1. **[エンドポイント]** ブレードを閉じます。

#### <a name="task-2-test-multimedia-content"></a>タスク 2: マルチメディア コンテンツをテストする

1. ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/campus.jpg** の相対パスと組み合わせて、**campus.jpg** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnmediastudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnmediastudent.azureedge.net/campus.jpg` になります。

1. ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/conference.jpg** の相対パスと組み合わせて、**conference.jpg** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnmediastudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnmediastudent.azureedge.net/conference.jpg` になります。

1. ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/poster.jpg** の相対パスと組み合わせて、**poster.jpg** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnmediastudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnmediastudent.azureedge.net/poster.jpg` になります。

1. ラボで前にコピーした **cdnvideo** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/welcome.mp4** の相対パスと組み合わせて、**welcome.mp4** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnvideostudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnvideostudent.azureedge.net/welcome.mp4` になります。

1. タスク バーで、**Microsoft Edge** アイコンのショートカット メニューをアクティブにしてから、 **[新しいウィンドウ]** を選択します。

1. 新しいブラウザー ウィンドウで、**campus.jpg** メディア リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

    > <bpt id="p1">**</bpt>Note<ept id="p1">**</ept>: If the content isn't available yet, the CDN endpoint is still initializing. This initialization process can take anywhere from 5 to 15 minutes.

1. **conference.jpg** メディア リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

1. **poster.jpg** メディア リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

1. **welcome.mp4** ビデオ リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

1. このタスクで作成したブラウザー ウィンドウを閉じます。

#### <a name="task-3-update-the-web-app-settings"></a>タスク 3: Web アプリの設定を更新する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードの **[設定]** カテゴリで **[構成]** リンクを選択します。

1. **[構成]** セクションで **[アプリケーション設定]** タブを選択します。

1. 既存の **CDNMediaEndpoint** アプリケーション設定を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ダイアログボックスで、ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を入力して **[値]** ボックスを更新し、 **[OK]** を選択します。

1. 既存の **CDNVideoEndpoint** アプリケーション設定を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ダイアログボックスで、ラボで前にコピーした **cdnvideo** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を入力して **[値]** ボックスを更新し、 **[OK]** を選択します。

1. **[保存]** を選択してから、 **[続行]** を選択して変更を確定します。  

   > **注**: アプリケーション設定が保持されるまで待ってから、このラボを続行してください。

1. **[構成]** セクションで **[概要]** を選択します。

1. **[概要]** セクションで **[再起動]** を選択し、 **[はい]** を選択して、アプリの再起動プロセスを確定します。

   > <bpt id="p1">**</bpt>Note<ept id="p1">**</ept>: Wait for the restart operation to complete before you continue with the lab. You'll receive a notification when the operation is done.

#### <a name="task-4-test-the-web-content"></a>タスク 4: Web コンテンツをテストする

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** リンクを選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contentdeliverynetwork** CDN プロファイルを選択します。

1. **[CDN プロファイル]** ブレードで **cdnweb** _[yourname]_ エンドポイントを選択します。

1. **[エンドポイント]** ブレードで **[エンドポイントのホスト名]** リンクの値をコピーします。

1. タスク バーで、**Microsoft Edge** アイコンのショートカット メニューをアクティブにしてから、 **[新しいウィンドウ]** を選択します。

1. 新しいブラウザー ウィンドウで、**cdnweb** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を参照します。

1. Content Delivery Network を使用して提供される、Web サイトとマルチメディアのコンテンツを確認します。

#### <a name="review"></a>確認

この演習では、Content Delivery Network を使用してマルチメディア コンテンツと Web アプリケーション自体が提供されるように Web アプリを更新しました。

### <a name="exercise-5-clean-up-your-subscription"></a>演習 5: サブスクリプションをクリーンアップする

#### <a name="task-1-open-azure-cloud-shell"></a>タスク 1: Azure Cloud Shell を開く

1. In the Azure portal, select the <bpt id="p1">**</bpt>Cloud Shell<ept id="p1">**</ept> icon <ph id="ph1">![</ph>Cloud Shell icon<ph id="ph2">](./media/az204_lab_CloudShell.png)</ph> to open a new Bash session. If Cloud Shell defaults to a PowerShell session, select <bpt id="p1">**</bpt>PowerShell<ept id="p1">**</ept>, and then in the drop-down menu, select <bpt id="p2">**</bpt>Bash<ept id="p2">**</ept>.

    > <bpt id="p1">**</bpt>Note<ept id="p1">**</ept>: If this is the first time you're starting <bpt id="p2">**</bpt>Cloud Shell<ept id="p2">**</ept>, when prompted to select either <bpt id="p3">**</bpt>Bash<ept id="p3">**</ept> or <bpt id="p4">**</bpt>PowerShell<ept id="p4">**</ept>, select <bpt id="p5">**</bpt>PowerShell<ept id="p5">**</ept>. When you're presented with the <bpt id="p1">**</bpt>You have no storage mounted<ept id="p1">**</ept> message, select the subscription you're using in this lab, and select <bpt id="p2">**</bpt>Create storage<ept id="p2">**</ept>.

#### <a name="task-2-delete-a-resource-group"></a>タスク 2: リソース グループを削除する

1. **[Cloud Shell]** ウィンドウで、次のコマンドを実行して **MonitoredContent** リソース グループを削除します。

    ```bash
    az group delete --name MarketingContent --no-wait --yes
    ```

     > **注**: このコマンドは非同期 ( *--no-wait* パラメーターによって決定されます) で実行されるため、同じ Bash セッション内で、直後に別の Azure CLI コマンドを実行できますが、リソース グループが実際に削除されるまでに数分かかります。

1. portal の **[Cloud Shell]** ペインを閉じます。

#### <a name="task-3-close-the-active-application"></a>タスク 3: アクティブなアプリケーションを閉じる

1. 現在実行中の Microsoft Edge アプリケーションを閉じます。

#### <a name="review"></a>確認

この演習では、このラボで使用したリソース グループを削除してサブスクリプションをクリーンアップしました。
