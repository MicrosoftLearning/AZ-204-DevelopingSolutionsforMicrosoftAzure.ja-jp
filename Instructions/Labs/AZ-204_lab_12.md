---
lab:
  az204Title: 'Lab 12: Enhance a web application by using the Azure Content Delivery Network'
  az204Module: 'Learning Path 12: Implement caching for solutions'
---

# ラボ 12: Azure Content Delivery Network を使用した Web アプリケーションの強化

## Microsoft Azure ユーザー インターフェイス

Microsoft クラウド ツールの動的な性質を考慮すると、このトレーニング コンテンツの開発の後に発生する Azure UI の変更に気付くかもしれません。 その結果、ラボの指示とラボの手順が正しく整合しなくなる可能性があります。

Microsoft は、コミュニティから必要な変更の通知があったときに、このトレーニング コースを更新します。 ただし、クラウドの更新は頻繁に発生するため、このトレーニング コンテンツの更新の前に UI の変更に気付く可能性があります。 **これが発生した場合は、その変更に適応し、ラボでは必要に応じてそれらに対応してください。**

## Instructions

### 開始する前に

#### ラボ環境にサインインする

次の資格情報を使用して Windows 10 仮想マシン (VM) にサインインします。

- ユーザー名: `Admin`
- パスワード: `Pa55w.rd`

> **注**: 仮想ラボ環境に接続するための手順は、インストラクターから提供されます。

#### インストールされているアプリケーションを確認する

Windows 10 デスクトップでタスク バーを見つけます。 タスク バーには、このラボで使用するアプリケーションのアイコンが含まれています。

- Microsoft Edge

## 課題シナリオ

このラボでは、Azure Content Delivery Network 機能を実装して、顧客の場所に基づいてキャッシュ ソリューションを提供します。 ラボでは、待機時間の問題によって最も影響を受ける画像およびビデオ ファイルのストレージ アカウントを構成します。 Azure Content Delivery Network を使用してキャッシュ ソリューションを実装し、これらの画像およびビデオ ファイルの待機時間を短縮できるようにします。

## アーキテクチャの図

![Azure Content Delivery Network を使用して web アプリケーションを強化するユーザーを表すアーキテクチャの図](./media/Lab12-Diagram.png)

### 演習 1: Azure リソースを作成する

#### タスク 1: Azure portal を開く

1. タスク バーで、**Microsoft Edge** アイコンを選択します。

1. 開いたブラウザー ウィンドウで、Azure portal (`https://portal.azure.com`) に移動してから、このラボで使用するアカウントでサインインします。

   > **注**:初めて Azure portal にサインインする場合は、このポータルのツアーが表示されます。 **[はじめに]** を選択してツアーをスキップし、ポータルの使用を開始します。

#### タスク 2: ストレージ アカウントを作成する

1. Azure portal で、 **[リソース、サービス、ドキュメントの検索]** テキスト ボックスを使用して「**ストレージ アカウント**」を検索し、結果のリストで **[ストレージ アカウント]** を選択します。

1. **[ストレージ アカウント]** ブレードで **[+ 作成]** を選択します。

1. [**ストレージ アカウントを作成する**] ブレードの [**基本**] タブで、次のアクションを実行します。

   | 設定 | アクション |
   | -- | -- |
   | **[サブスクリプション]** ドロップダウン リスト | 既定値のままにします |
   | **[リソース グループ]** セクション | **[新規作成]** を選択し、「**MarketingContent**」と入力し、 **[OK]** を選択します。 |
   | **[ストレージ アカウント名]** テキスト ボックス | 「**contenthost** _[ご自分の名前]_ 」と入力します |
   | **[リージョン]** ドロップダウン リスト | **[(米国) 米国東部]** を選択します |
   | **[パフォーマンス]** セクション | **[Standard]** オプションを選択します |
   | **[冗長性]** ドロップダウン リスト | **[ローカル冗長ストレージ (LRS)]** を選択します |

    次のスクリーンショットには、 **[ストレージ アカウントを作成する]** ブレードで構成された設定が表示されています。

    ![[ストレージ アカウントを作成する] ブレードで構成された設定を表示したスクリーンショット](./media/l12_create_a_storage_account.png)

1. [**詳細設定**] タブで、[**個々のコンテナーでのパブリック アクセスの有効化を許可する**] が有効になっていることを確認します。 有効になっていない場合は、チェック ボックスをオンにします。

1. **[確認]** タブで、前の手順で選択したオプションを確認します。

1. **[作成]** を選択して、指定した構成を使用してストレージ アカウントを作成します。

    > **注**: 作成タスクが完了するまで待ってから、このラボを続行してください。

#### タスク 3: Azure App Service を使用して Web アプリを作成する

1. Azure portal のナビゲーション ウィンドウで **[リソースの作成]** を選択します。

1. **[リソースの作成]** ブレードで、**[サービスとマーケットプレースの検索]** テキスト ボックスに「**Web アプリ**」と入力し、Enter キーを押します。

1. 検索結果ブレードで、"**Web アプリ**" という結果を選択し、 **[作成]** を選択します。

1. **[Web アプリの作成]** ブレードの **[基本]** タブで、次のアクションを実行してから、 **[次へ: Docker]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[サブスクリプション]** ドロップダウン リスト | 既定値のままにします |
   | **[リソース グループ]** ドロップダウン リスト | リストで **[MarketingContent]** を選択します。 |
   | **[名前]** テキスト ボックス | 「**landingpage** _[ご自分の名前]_ 」と入力します。 |
   | **[公開]** セクション | **[Docker コンテナー]** を選択します |
   | **[オペレーティング システム]** セクション | **[Linux]** を選択します |
   | **[リージョン]** ドロップダウン リスト | **[米国東部]** を選択します。 |
   | **[Linux プラン (米国東部)]** セクション | **[新規作成]** を選択します。 **[名前]** テキスト ボックスに「**MarketingPlan**」と入力し、 **[OK]** を選択します |
   | **[価格プラン]** セクション | 既定値のままにします |

   次のスクリーンショットは、 **[Web アプリの作成]** ブレードで構成されている設定を示しています。

   ![[Web アプリの作成] ブレードで構成された設定を表示したスクリーンショット](./media/l12_create_web_app.png)

1. **[Docker]** タブで、次のアクションを実行し、 **[確認と作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[オプション]** ドロップダウン リスト | **[単一コンテナー]** を選択します |
   | **[イメージのソース]** ドロップダウン リスト | **[Docker Hub]** を選択します |
   | **[アクセスの種類]** ドロップダウン リスト | **[Public]** を選択します |
   | **[イメージとタグ]** テキスト ボックス | 「**microsoftlearning/edx-html-landing-page:latest**」と入力します。 |

   次のスクリーンショットは、 **[Docker]** タブで構成されている設定を示しています。

   ![[Web アプリの作成] の [Docker] タブで構成されている設定を表示したスクリーンショット](./media/l12_create_web_app_docker.png)

1. **[確認と作成]** タブで、前の手順で選択したオプションを確認します。

1. **[作成]** を選択して、指定した構成を使用して Web アプリを作成します。

    > **注**: 作成タスクが完了するまで待ってから、このラボを続行してください。

1. **[デプロイ]** ブレードで、**[リソースに移動]** を選択します。

1. **[App Service の概要]** ブレードの **[要点]** で、 **[既定のドメイン]** リンクの値を記録します。 この値は、ラボの後半で使用します。

#### 確認

この演習では、このラボで後ほど使用する Azure Storage アカウントと Azure Web アプリを作成しました。

### 演習 2: Content Delivery Network とエンドポイントを構成する

#### タスク 1: Azure Cloud Shell を開く

1. Azure portal で **Cloud Shell** アイコン ![Cloud Shell アイコン](./media/az204_lab_CloudShell.png) を選択して、新しい Bash セッションを開きます。 Cloud Shell が既定で PowerShell セッションに設定されている場合は、 **[PowerShell]** を選択し、ドロップダウン メニューで **[Bash]** を選択します。

    > **注**: 初めて **Cloud Shell** を起動する場合は、 **[Bash]** または **[PowerShell]** のいずれかを選択するよう求めるメッセージが表示されたら、 **[Bash]** を選択します。 **[ストレージがマウントされていません]** というメッセージが表示されたら、このラボで使用しているサブスクリプションを選択し、 **[ストレージの作成]** を選択します。

1. Azure portal の **Cloud Shell** コマンド プロンプトで、次のコマンドを実行して、Azure コマンド ライン インターフェイス (Azure CLI) ツールのバージョンを取得します。

    ```bash
    az --version
    ```

#### タスク 2: Microsoft.CDN プロバイダーを登録する

1. Azure portal の **Cloud Shell** コマンド プロンプトで、次の操作を実行します。

    a.  次のコマンドを入力して、Microsoft.CDN が登録されたかどうかを確認します。 手順 2 に進みます。 Microsoft.CDN が既に登録されている場合:

    ```bash
    az provider show --namespace Microsoft.CDN --query "registrationState"
    ```

    b.  Microsoft.CDN が登録されていない場合。 次のコマンドを入力し、Enter キーを押して、現在のサブスクリプションに **Microsoft.CDN** 名前空間を登録します。

    ```bash
    az provider register --namespace Microsoft.CDN
    ```

1. Azure portal の **[Cloud Shell]** ウィンドウを閉じます。

#### タスク 3: Content Delivery Network プロファイルを作成する

1. Azure portal のナビゲーション ウィンドウで **[リソースの作成]** を選択します。

1. **[リソースの作成]** ブレードの **[サービスとマーケットプレースの検索]** テキスト ボックスに「**CDN**」と入力し、Enter キーを押します。

1. **[マーケットプレース]** 検索結果ブレードで、 **[Front Door と CDN プロファイル]** という結果を選択し、 **[作成]** を選択します。

1. **[オファリングの比較]** ページで、 **[その他のオファリングの探索]** を選択し、 **[Azure CDN Standard from Microsoft (クラシック)]** を選んでから、 **[続行]** を選択します。

1. **[CDN プロファイル]** ブレードの **[基本]** タブで、次のアクションを実行してから、 **[確認と作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[サブスクリプション]** ドロップダウン リスト | 既定値のままにします |
   | **[リソース グループ]** ドロップダウン リスト | リストで **[MarketingContent]** を選択します。 |
   | **[名前]** テキスト ボックス | 「**contentdeliverynetwork**」と入力します |
   | **[領域]** テキスト ボックス | 既定値の **[グローバル]** のままにします |
   | **[価格レベル]** ドロップダウン リスト | 既定値の **[Microsoft CDN (クラシック)]** のままにします |
   | **[新しい CDN エンドポイントを作成する]** チェック ボックス | オフ |

   次のスクリーンショットは、 **[CDN プロファイル]** ブレードで構成されている設定を示しています。

   ![[CDN プロファイルの作成] ブレードで構成された設定を表示したスクリーンショット。](./media/l12_create_CDN_profile.png)

1. **[確認と作成]** タブで、前の手順で選択したオプションを確認します。

1. **[作成]** を選択して、指定した構成を使用して CDN プロファイルを作成します。
  
    > **注**: Azure が CDN プロファイルの作成を完了するまで待ってから、ラボを続行してください。 プロファイルが作成されると通知が届きます。

#### タスク 4: ストレージ コンテナーを構成する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contenthost** _[yourname]_ ストレージ アカウントを選択します。

1. **[ストレージ アカウント]** ブレードで、 **[データ ストレージ]** セクションの **[コンテナー]** リンクを選択します。

1. **[コンテナー]** セクションで、 **[+ コンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップ ウィンドウで、次のアクションを実行し、 **[作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**media**」と入力します |
   | **[パブリック アクセス レベル]** ドロップダウン リスト | **[BLOB (BLOB 専用の匿名読み取りアクセス)]** を選択します。 |

1. **[コンテナー]** セクションで、もう一度、 **[+ コンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップ ウィンドウで、次のアクションを実行し、 **[作成]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**video**」と入力します |
   | **[パブリック アクセス レベル]** ドロップダウン リスト | **[BLOB (BLOB 専用の匿名読み取りアクセス)]** を選択します。 |

1. 更新されたコンテナーの一覧で、**media** コンテナーと **video** コンテナーが両方とも表示されていることを確認します。

#### タスク 5: Content Delivery Network エンドポイントを作成する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** リンクを選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contentdeliverynetwork** CDN プロファイルを選択します。

1. **[CDN プロファイル]** ブレードで **[+ エンドポイント]** を選択します。

1. **[エンドポイントの追加]** ポップアップ ダイアログ ボックスで、次の操作を実行し、 **[追加]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**cdnmedia**_<ご自分の名前>_」と入力します |
   | **[配信元の種類]** ドロップダウン リスト | **[ストレージ]** を選びます |
   | **[配信元のホスト名]** ドロップダウン リスト | このラボで前に作成したストレージ アカウントの **[contenthost *[ご自分の名前]* .blob.core.windows.net]** オプションを選択します |
   | **[配信元のパス]** テキスト ボックス | 「**/media**」と入力します |
   | **[配信元のホスト ヘッダー]** テキスト ボックス | 既定値のままにします |
   | **[プロトコル]** セクションと **[配信元のポート]** セクション | 既定値のままにします |
   | **[最適化の対象]** ドロップダウン リスト | **[一般的な Web 配信]** を選択します |

   次のスクリーンショットには、 **[エンドポイントの追加]** ダイアログ ボックスで構成された設定が表示されています。

   ![次のスクリーンショットには、[エンドポイントの追加] ダイアログ ボックスで構成された設定が表示されています。](./media/l12_add_an_endpoint.png)

1. **[CDN プロファイル]** ブレードで、もう一度、 **[+ エンドポイント]** を選択します。

1. **[エンドポイントの追加]** ポップアップ ダイアログ ボックスで、次の操作を実行し、 **[追加]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**cdnvideo**_<ご自分の名前>_」と入力します |
   | **[配信元の種類]** ドロップダウン リスト | **[ストレージ]** を選びます |
   | **[配信元のホスト名]** ドロップダウン リスト | このラボで前に作成したストレージ アカウントの **[contenthost *[ご自分の名前]* .blob.core.windows.net]** オプションを選択します |
   | **[配信元のパス]** テキスト ボックス | 「**/video**」と入力します |
   | **[配信元のホスト ヘッダー]** テキスト ボックス | 既定値のままにします |
   | **[プロトコル]** セクションと **[配信元のポート]** セクション | 既定値のままにします |
   | **[最適化の対象]** ドロップダウン リスト | **[一般的な Web 配信]** を選択します |

   次のスクリーンショットには、 **[エンドポイントの追加]** ダイアログ ボックスで構成された設定が表示されています。

   ![次のスクリーンショットには、[エンドポイントの追加] ダイアログ ボックスで構成された設定が表示されています。](./media/l12_add_an_endpoint2.png)

1. **[CDN プロファイル]** ブレードで、もう一度、 **[+ エンドポイント]** を選択します。

1. **[エンドポイントの追加]** ポップアップ ダイアログ ボックスで、次の操作を実行し、 **[追加]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**cdnweb**_<ご自分の名前>_」と入力します |
   | **[配信元の種類]** ドロップダウン リスト | **[Web アプリ]** を選択します |
   | **[配信元のホスト名]** ドロップダウン リスト | このラボで前に作成した、Web アプリの **[landingpage *[ご自分の名前]* .azurewebsites.net]** オプションを選択します。 |
   | **[配信元のパス]** テキスト ボックス | 既定値のままにします |
   | **[配信元のホスト ヘッダー]** テキスト ボックス | 既定値のままにします |
   | **[プロトコル]** セクションと **[配信元のポート]** セクション | 既定値のままにします |
   | **[最適化の対象]** ドロップダウン リスト | **[一般的な Web 配信]** を選択します |

   次のスクリーンショットには、 **[エンドポイントの追加]** ダイアログ ボックスで構成された設定が表示されています。

   ![次のスクリーンショットには、[エンドポイントの追加] ダイアログ ボックスで構成された設定が表示されています。](./media/l12_add_an_endpoint3.png)

#### 確認

この演習では、Content Delivery Network (CDN) のリソース プロバイダーを登録し、次に、プロバイダーを使用して CDN プロファイルとエンドポイント リソースの両方を作成しました。

### 演習 3: 静的 Web コンテンツをアップロードし、構成する

#### タスク 1: ランディング ページを確認する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードで **[参照]** を選択します。 新しいブラウザー タブが開き、現在の Web サイトが返されます。 画面に表示されるエラー メッセージを確認します。 マルチメディア コンテンツを参照するために指定された設定を構成するまで、Web サイトは機能しません。

1. 現在、開いているブラウザー ウィンドウに戻ります。ここには、Azure portal が表示されています。

#### タスク 2: Storage BLOB をアップロードする

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contenthost** _[yourname]_ ストレージ アカウントを選択します。

1. **[ストレージ アカウント]** ブレードで、 **[データ ストレージ]** セクションの **[コンテナー]** リンクを選択します。

1. **[コンテナー]** セクションで **media** コンテナーを選択し、 **[アップロード]** を選択します。

1. **[BLOB のアップロード]** ポップアップ ウィンドウで、次のアクションを実行します。

    a.  **[ファイル]** セクションで、 **[ファイルの参照]** を選択するか、ドラッグ アンド ドロップ機能を使用します。

    b.  **エクスプローラー** ウィンドウで **Allfiles (F):\\Allfiles\\Labs\\12\\Starter** に移動し、以下のファイルを選択してから、 **[開く]** を選択します。

    - **campus.jpg**

    - **conference.jpg**

    - **poster.jpg**

    c.  **[ファイルが既に存在する場合は上書きする]** が選択されていることを確認し、 **[アップロード]** を選択します。  

    > **注**: BLOB がアップロードされるまで待ってから、このラボを続行してください。

1. **[コンテナー]** ブレードで、 **[設定]** セクションの **[プロパティ]** を選択します。

1. **[URL]** テキスト ボックスの値を記録します。 この値は、ラボの後半で使用します。

1. **[コンテナー]** ブレードを閉じます。

1. **[コンテナー]** ブレードで **video** コンテナーを選択し、 **[アップロード]** を選択します。

1. **[BLOB のアップロード]** ポップアップ ウィンドウで、次のアクションを実行します。

    a.  **[ファイル]** セクションで、 **[ファイルの参照]** を選択するか、ドラッグ アンド ドロップ機能を使用します。

    b.  **エクスプローラー** ウィンドウで **Allfiles (F):\\Allfiles\\Labs\\12\\Starter** に移動し、**welcome.mp4** ファイルを選択してから、 **[開く]** を選択します。

    c.  **[ファイルが既に存在する場合は上書きする]** が選択されていることを確認し、 **[アップロード]** を選択します。  

    > **注**: BLOB がアップロードされるまで待ってから、このラボを続行してください。

1. **[コンテナー]** ブレードで、 **[設定]** セクションの **[プロパティ]** を選択します。

1. **[URL]** テキスト ボックスの値を記録します。 この値は、ラボの後半で使用します。

#### タスク 3: Web アプリの設定を構成する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードの **[設定]** カテゴリで **[構成]** リンクを選択します。

1. **[構成]** セクションで **[アプリケーション設定]** タブを選択してから、 **[新しいアプリケーション設定]** を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ウィンドウで、以下の設定を構成し、 **[OK]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**CDNMediaEndpoint**」と入力します |
   | **[値]** テキスト ボックス | このラボで前に記録した、**contenthost** _[ご自分の名前]_ ストレージ アカウントの **media** コンテナーの **URI** 値を入力します。 |
   | **[デプロイ スロットの設定]** チェック ボックス | 選択しません |

1. **[構成]** セクション に戻り、 **[新しいアプリケーション設定]** を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ウィンドウで、以下の設定を構成し、 **[OK]** を選択します。

   | 設定 | アクション |
   | -- | -- |
   | **[名前]** テキスト ボックス | 「**CDNVideoEndpoint**」と入力します。 |
   | **[値]** テキスト ボックス | このラボで前に記録した、**contenthost** _[ご自分の名前]_ ストレージ アカウントの **video** コンテナーの **URI** 値を入力します |
   | **[デプロイ スロットの設定]** チェック ボックス | 選択しません |

1. **[構成]** セクション に戻り、 **[保存]** を選択します。 **[続行]** を選択して変更を確定します。

   > **注**: アプリケーション設定が保持されるまで待ってから、このラボを続行してください。

#### タスク 4: 修正されたランディング ページを検証する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードで **[再起動]** を選択し、 **[はい]** を選択して、アプリの再起動プロセスを確定します。

   > **注**: 再起動の動作が完了するまで待ってから、このラボを続行してください。 動作が完了すると、通知が表示されます。

1. **[App Service]** ブレードで **[参照]** を選択します。 新しいブラウザー ウィンドウまたはタブが開き、現在の Web サイトに戻ります。 更新された Web サイトで、さまざまな種類のマルチメディア コンテンツが表示されていることを確認します。

1. 現在、開いているブラウザー ウィンドウに戻ります。ここには、Azure portal が表示されています。

#### 確認

この演習では、マルチメディア コンテンツを BLOB としてストレージ コンテナーにアップロードした後、Web アプリを更新してストレージ BLOB を直接指すようにしました。

### 演習 4: Content Delivery Network エンドポイントを使用する

#### タスク 1: エンドポイントの Uniform Resource Identifier (URI) を取得する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** リンクを選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contentdeliverynetwork** CDN プロファイルを選択します。

1. **[CDN プロファイル]** ブレードで **cdnmedia** _[yourname]_ エンドポイントを選択します。

1. **[エンドポイント]** ブレードで **[エンドポイントのホスト名]** リンクの値をコピーします。 この値は、ラボの後半で使用します。

1. **[エンドポイント]** ブレードを閉じます。

1. **[CDN プロファイル]** ブレードで **cdnvideo** _[yourname]_ エンドポイントを選択します。

1. **[エンドポイント]** ブレードで **[エンドポイントのホスト名]** リンクの値をコピーします。 この値は、ラボの後半で使用します。

1. **[エンドポイント]** ブレードを閉じます。

#### タスク 2: マルチメディア コンテンツをテストする

1. ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/campus.jpg** の相対パスと組み合わせて、**campus.jpg** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnmediastudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnmediastudent.azureedge.net/campus.jpg` になります。

1. ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/conference.jpg** の相対パスと組み合わせて、**conference.jpg** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnmediastudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnmediastudent.azureedge.net/conference.jpg` になります。

1. ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/poster.jpg** の相対パスと組み合わせて、**poster.jpg** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnmediastudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnmediastudent.azureedge.net/poster.jpg` になります。

1. ラボで前にコピーした **cdnvideo** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を、 **/welcome.mp4** の相対パスと組み合わせて、**welcome.mp4** リソースの URL を構築します。

    > **注**: たとえば、 **[エンドポイントのホスト名]** の URL が `https://cdnvideostudent.azureedge.net/` である場合は、新しく構築される URL が `https://cdnvideostudent.azureedge.net/welcome.mp4` になります。

1. タスク バーで、**Microsoft Edge** アイコンのショートカット メニューをアクティブにしてから、 **[新しいウィンドウ]** を選択します。

1. 新しいブラウザー ウィンドウで、**campus.jpg** メディア リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

    > **注**: コンテンツがまだ使用できない場合は、CDN エンドポイントが、まだ初期化中です。 この初期化プロセスには、5 ～ 15 分かかることがあります。

1. **conference.jpg** メディア リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

1. **poster.jpg** メディア リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

1. **welcome.mp4** ビデオ リソース用に作成した URL を参照し、リソースが正常に検出されたことを確認します。

1. このタスクで作成したブラウザー ウィンドウを閉じます。

#### タスク 3: Web アプリの設定を更新する

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** を選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[ManagedContent]** ブレードで、このラボで前に作成した **landingpage** _[yourname]_ Web アプリを選択します。

1. **[App Service]** ブレードの **[設定]** カテゴリで **[構成]** リンクを選択します。

1. **[構成]** セクションで **[アプリケーション設定]** タブを選択します。

1. 既存の **CDNMediaEndpoint** アプリケーション設定を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ダイアログボックスで、ラボで前にコピーした **cdnmedia** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を入力して **[値]** ボックスを更新し、 **[OK]** を選択します。

1. 既存の **CDNVideoEndpoint** アプリケーション設定を選択します。

1. **[アプリケーション設定の追加/編集]** ポップアップ ダイアログボックスで、ラボで前にコピーした **cdnvideo** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を入力して **[値]** ボックスを更新し、 **[OK]** を選択します。

1. **[保存]** を選択してから、 **[続行]** を選択して変更を確定します。  

   > **注**: アプリケーション設定が保持されるまで待ってから、このラボを続行してください。

1. **[構成]** セクションで **[概要]** を選択します。

1. **[概要]** セクションで **[再起動]** を選択し、 **[はい]** を選択して、アプリの再起動プロセスを確定します。

   > **注**: 再起動の動作が完了するまで待ってから、このラボを続行してください。 動作が完了すると、通知が表示されます。

#### タスク 4: Web コンテンツをテストする

1. Azure portal のナビゲーション ウィンドウで **[リソース グループ]** リンクを選択します。

1. **[リソース グループ]** ブレードで、このラボで前に作成した **ManagedContent** リソース グループを選択します。

1. **[MarketingContent]** ブレードで、このラボで前に作成した **contentdeliverynetwork** CDN プロファイルを選択します。

1. **[CDN プロファイル]** ブレードで **cdnweb** _[yourname]_ エンドポイントを選択します。

1. **[エンドポイント]** ブレードで **[エンドポイントのホスト名]** リンクの値をコピーします。

1. タスク バーで、**Microsoft Edge** アイコンのショートカット メニューをアクティブにしてから、 **[新しいウィンドウ]** を選択します。

1. 新しいブラウザー ウィンドウで、**cdnweb** _[yourname]_ エンドポイントの **[エンドポイントのホスト名]** の URL を参照します。

1. Content Delivery Network を使用して提供される、Web サイトとマルチメディアのコンテンツを確認します。

#### 確認

この演習では、Content Delivery Network を使用してマルチメディア コンテンツと Web アプリケーション自体が提供されるように Web アプリを更新しました。
